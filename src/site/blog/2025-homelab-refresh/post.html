<h1>Homelab refresh notes</h1>
<p>Quick checkpoint on rearranging the small rack at home. Nothing fancy — just wiring and monitoring tweaks.</p>
<p><img alt="Rack sketch" src="./homelab-rack.svg">
<img alt="alt text" src="image.png">
Some context:</p>
<ul>
<li>Moved the Proxmox nodes to separate PDUs to avoid a single power bar failure.</li>
<li>Split management and storage traffic; kept k3s traffic on VLAN 30.</li>
<li>Replaced the noisy 1U router fan with a Noctua and dropped temps by ~6°C.</li>
<li>Enabled disk SMART scraping in Prometheus and added Grafana alerts for pre-fail attributes.</li>
</ul>
<p>The change log is intentionally short; I want these posts to stay readable on a phone.</p>
<pre class="codehilite"><code class="language-python">import datetime
import jinja2
import pathlib
import markdown


root_dir = pathlib.Path(__file__).resolve().parent
src = root_dir / &quot;src&quot;
site = src / &quot;site&quot;
out = root_dir / &quot;out&quot;


def convert_markdown_to_html_in_place(p: pathlib.Path) -&gt; None:
    if p.is_file() and p.name.endswith(&quot;.md&quot;):
        content = p.read_text()

        md_out_file = p.with_suffix(&quot;.html&quot;)
        md_content = markdown.markdown(content)

        if md_out_file.exists() and md_out_file.read_text() == md_content:
            return

        md_out_file.write_text(md_content)

    elif p.is_dir():
        for nested_path in p.iterdir():
            convert_markdown_to_html_in_place(nested_path)
        return


def process_path(p: pathlib.Path, context: dict) -&gt; None:
    rel_src = p.relative_to(src)
    rel_site = p.relative_to(site)

    out_file = out / rel_site
    out_file.parent.mkdir(parents=True, exist_ok=True)

    if p.is_file() and p.name.endswith(&quot;.html&quot;):
        content = environment.get_template(str(rel_src)).render(context)
    elif p.is_dir():
        for nested_path in p.iterdir():
            process_path(nested_path, context)
        return
    else:
        content = p.read_bytes()
        out_file.write_bytes(content)
        return

    out_file.write_text(content)


if __name__ == &quot;__main__&quot;:
    out.mkdir(exist_ok=True)

    environment = jinja2.Environment(loader=jinja2.FileSystemLoader(src))

    for path in (site / &quot;_data&quot;).iterdir():
        convert_markdown_to_html_in_place(path)

    convert_markdown_to_html_in_place(site / &quot;blog&quot;)

    context = {&quot;build_timestamp&quot;: int(datetime.datetime.now(datetime.UTC).timestamp())}

    for path in site.iterdir():
        process_path(path, context)
</code></pre>

<p><br><br></p>
<hr>
<p><em>Last updated: 2025-12-22</em></p>
<p>Content license: CC BY-NC 4.0 — share and adapt with attribution, no commercial use.</p>